
################################################################################
#                                                                              #
#                         CASEGEN - TESTE DE ENDPOINTS                        #
#                                                                              #
################################################################################

################################################################################
# üß™ TESTES R√ÅPIDOS DE ETAPAS INDIVIDUAIS
################################################################################

### TEST 1 - Validar Encoding JSON (1 segundo)
# Testa se arquivos JSON est√£o sendo salvos sem double-encoding

POST http://localhost:7071/api/TestJsonEncoding
Content-Type: application/json

{
  "caseId": "CASE-20251027-9e3f82ea"
}

### TEST 2 - Normalizar Entidades (1-2 segundos)
# Testa normaliza√ß√£o de suspects e evidence de um caso existente
# Requer: Caso com expand/suspects/* e expand/evidence/* no blob

POST http://localhost:7071/api/TestNormalizeEntities
Content-Type: application/json

{
  "caseId": "CASE-20251027-9e3f82ea"
}

### TEST 3 - Gerar Imagens de Caso Existente (15-20 minutos)
# Gera todas as imagens de um caso que j√° foi criado
# √ötil quando o caso foi gerado com generateImages=false
# Requer: Caso com design/media/*.json no blob storage

POST http://localhost:7071/api/TestGenerateImages
Content-Type: application/json

{
  "caseId": "CASE-20251027-9e3f82ea"
}


################################################################################
# üì¶ GERA√á√ÉO DE CASO COMPLETO
################################################################################

### Gerar Caso R√ÅPIDO (sem imagens, sem PDFs) - 3-5 minutos
# Recomendado para desenvolvimento e testes r√°pidos

POST http://localhost:7071/api/StartCaseGeneration
Content-Type: application/json

{
  "difficulty": "Rookie",
  "generateImages": false,
  "renderFiles": false,
  "timezone": "America/Toronto"
}

### Gerar Caso COM IMAGENS (sem PDFs) - 15-20 minutos

POST http://localhost:7071/api/StartCaseGeneration
Content-Type: application/json

{
  "difficulty": "Rookie",
  "generateImages": true,
  "renderFiles": false,
  "timezone": "America/Toronto"
}

### Gerar Caso COMPLETO (imagens + PDFs) - 25-30 minutos
# Produ√ß√£o - tudo inclu√≠do

POST http://localhost:7071/api/StartCaseGeneration
Content-Type: application/json

{
  "difficulty": "Rookie",
  "generateImages": true,
  "renderFiles": true,
  "timezone": "America/Toronto"
}

### Gerar Caso com Dificuldade Aleat√≥ria

POST http://localhost:7071/api/StartCaseGeneration
Content-Type: application/json

{
  "generateImages": false,
  "renderFiles": false,
  "timezone": "UTC"
}

{
  "generateImages": true,
  "renderFiles": false
}

###

# Levels: Rookie | Detective| Detective2 | Sergeant | Captain | Commander
# Caso de n√≠vel avan√ßado (SEM RENDERIZA√á√ÉO)
POST http://localhost:7071/api/StartCaseGeneration

{
  "difficulty": "Sergeant",
  "renderFiles": false
}

###

# Caso de n√≠vel extremo (COM RENDERIZA√á√ÉO COMPLETA)
POST http://localhost:7071/api/StartCaseGeneration

{
  "difficulty": "Commander",
  "generateImages": true,
  "renderFiles": true
}

###

GET http://localhost:7071/api/status/593a7ea794924f028624a369fe3e1e7d

###

# ============================================================================
# ENDPOINTS INDIVIDUAIS POR ETAPA
# ============================================================================

### ETAPA 1: Gerar apenas o PLANO
POST http://localhost:7071/api/PlanStep
Content-Type: application/json

{
  "difficulty": "Rookie",
  "generateImages": true,
  "timezone": "America/Toronto"
}

###

### ETAPA 2: Expandir o plano (usar o resultado da etapa anterior)
POST http://localhost:7071/api/ExpandStep
Content-Type: application/json

{
  "caseId": "CASE-20250906-12345678",
  "planJson": "{\"caseId\":\"CASE-20250906-12345678\",\"title\":\"Furto em Loja de Roupas\",\"difficulty\":\"Rookie\",\"location\":\"loja de roupas em √°rea comercial\",\"incidentType\":\"furto\",\"overview\":\"Desaparecimento de roupas de uma loja durante o per√≠odo noturno\"}"
}

###

### ETAPA 3: Criar design/especifica√ß√µes (usar resultado das etapas anteriores)
POST http://localhost:7071/api/DesignStep
Content-Type: application/json

{
  "caseId": "CASE-20250906-12345678",
  "planJson": "{\"caseId\":\"CASE-20250906-12345678\",\"title\":\"Furto em Loja de Roupas\",\"difficulty\":\"Rookie\"}",
  "expandedJson": "{\"suspects\":[{\"name\":\"Jo√£o Silva\",\"role\":\"Ex-funcion√°rio\"}],\"evidences\":[{\"id\":\"ev_001\",\"type\":\"physical\",\"description\":\"Chave duplicada\"}]}",
  "difficulty": "Rookie"
}

###

### ETAPA 4: Gerar documentos (usar specs do design)
POST http://localhost:7071/api/GenerateDocumentsStep
Content-Type: application/json

{
  "caseId": "CASE-20250906-12345678",
  "designJson": "{\"documentSpecs\":[{\"docId\":\"doc_001\",\"type\":\"police_report\",\"title\":\"Boletim de Ocorr√™ncia\",\"sections\":[\"Dados do Incidente\",\"Relato dos Fatos\"],\"lengthTarget\":[200,400],\"gated\":false}]}",
  "documentSpecs": [
    {
      "docId": "doc_001",
      "type": "police_report", 
      "title": "Boletim de Ocorr√™ncia - Furto",
      "sections": ["Dados do Incidente", "Relato dos Fatos", "Conclus√µes"],
      "lengthTarget": [200, 400],
      "gated": false
    },
    {
      "docId": "doc_002",
      "type": "evidence_log",
      "title": "Registro de Evid√™ncias",
      "sections": ["Lista de Evid√™ncias", "Observa√ß√µes"],
      "lengthTarget": [150, 300],
      "gated": false
    }
  ],
  "planJson": "{\"caseId\":\"CASE-20250906-12345678\",\"difficulty\":\"Rookie\"}",
  "expandJson": "{\"suspects\":[{\"name\":\"Jo√£o Silva\"}]}",
  "difficulty": "Rookie"
}

###

### ETAPA 5: Gerar m√≠dia (usar specs do design)
POST http://localhost:7071/api/GenerateMediaStep
Content-Type: application/json

{
  "caseId": "CASE-20250906-12345678",
  "designJson": "{\"mediaSpecs\":[{\"evidenceId\":\"ev_001\",\"kind\":\"photo\",\"title\":\"Foto da Chave\"}]}",
  "mediaSpecs": [
    {
      "evidenceId": "ev_001",
      "kind": "photo",
      "title": "Foto da chave duplicada",
      "prompt": "Fotografia forense de uma chave duplicada",
      "constraints": {
        "angle_deg": 90,
        "camera_height_m": 0.5,
        "aspect_ratio": "4:3",
        "resolution_px": "1920x1440"
      },
      "deferred": false
    },
    {
      "evidenceId": "ev_002", 
      "kind": "document_scan",
      "title": "Scan do crach√° de funcion√°rio",
      "prompt": "Digitaliza√ß√£o de crach√° de identifica√ß√£o de funcion√°rio",
      "constraints": {
        "resolution_px": "300dpi",
        "aspect_ratio": "3:2"
      },
      "deferred": false
    }
  ],
  "planJson": "{\"caseId\":\"CASE-20250906-12345678\",\"difficulty\":\"Rookie\"}",
  "difficulty": "Rookie"
}

###

### ETAPA 6: Normalizar caso completo
POST http://localhost:7071/api/NormalizeStep
Content-Type: application/json

{
  "caseId": "CASE-20250906-12345678",
  "documents": [
    "{\"docId\":\"doc_001\",\"type\":\"police_report\",\"title\":\"Boletim de Ocorr√™ncia\",\"sections\":[{\"title\":\"Dados do Incidente\",\"content\":\"Furto ocorrido em 2025-09-05...\"}]}",
    "{\"docId\":\"doc_002\",\"type\":\"evidence_log\",\"title\":\"Registro de Evid√™ncias\",\"sections\":[{\"title\":\"Lista\",\"content\":\"1. Chave duplicada...\"}]}"
  ],
  "media": [
    "{\"evidenceId\":\"ev_001\",\"kind\":\"photo\",\"title\":\"Foto da chave\",\"prompt\":\"Fotografia forense...\"}",
    "{\"evidenceId\":\"ev_002\",\"kind\":\"document_scan\",\"title\":\"Scan do crach√°\",\"prompt\":\"Digitaliza√ß√£o...\"}"
  ],
  "difficulty": "Rookie",
  "timezone": "America/Toronto"
}


###

# Teste de gera√ß√£o de PDF
POST http://localhost:7071/api/test/pdf

{
  "docId": "doc_evidence_log_001",
  "type": "evidence_log",
  "title": "Registro de Evid√™ncias - Assalto √† Caixa",
  "words": 359,
  "sections": [
    {
      "title": "Invent√°rio de Evid√™ncias",
      "content": "Legenda: tabela com invent√°rio e transfer√™ncias.\n\n| ItemId | Coleta em | Coletado por | Descri√ß√£o | Armazenamento | Transfer√™ncias |\n|---|---:|---|---|---|---|\n| ev_drawer_photo_001 | 2025-09-01T09:36:00-04:00 | Primeira equipe policial | Fotografia frontal da gaveta do caixa, trilhos remexidos | Pen-drive forense; c√≥pia no servidor | Local -> Per√≠cia (2025-09-01T11:15:00-04:00) |\n| ev_receipts_scan_001 | 2025-09-01T09:45:00-04:00 | Miguel Santos; Primeira equipe policial | Scans dos recibos e relat√≥rio de caixa (diferen√ßa $245) | PDF 300dpi em pen-drive forense | Local -> Per√≠cia (2025-09-01T11:15:00-04:00) |\n| ev_cctv_video_001 | 2025-09-01T10:10:00-04:00 | Per√≠cia Digital | Trecho de CCTV 09:20 (30‚Äì60s) com indiv√≠duo de capuz | MP4 em pen-drive forense; metadados extra√≠dos | Extra√ß√£o (2025-09-01T10:10:00-04:00) -> Laborat√≥rio (2025-09-01T11:15:00-04:00) |\n| ev_fingerprint_photo_001 | 2025-09-01T09:40:00-04:00 | Per√≠cia | Foto macro de impress√£o parcial no puxador; amostra em fita adesiva | Foto digital + amostra em envelope selado | Etiqueta iniciada (2025-09-01T09:40:00-04:00); Enviado √† Per√≠cia (2025-09-01T11:15:00-04:00) |\n| ev_footprint_photo_001 | 2025-09-01T09:37:00-04:00 | Primeira equipe policial | Marca de sola √∫mida na cal√ßada com r√©gua de escala | Foto digital; registro fotogr√°fico em servidor | Local -> Per√≠cia (2025-09-01T11:15:00-04:00) |"
    },
    {
      "title": "Descri√ß√£o Detalhada por Item",
      "content": "- ev_drawer_photo_001: Foto documenta gaveta parcialmente fora e sinais de arrombamento. N√£o foi removida do local na primeira patrulha; imagens servem para avalia√ß√£o.\n\n- ev_receipts_scan_001: Scans mostram vendas entre 09:00‚Äì09:20; relat√≥rio evidencia d√©ficit de $245. Arquivos com metadados de digitaliza√ß√£o.\n\n- ev_cctv_video_001: Trecho extra√≠do do DVR mostra entrada √†s 09:20; qualidade m√©dia impede identifica√ß√£o facial, mas permite estimativa de estatura.\n\n- ev_fingerprint_photo_001: Impress√£o parcial de dois dedos em p√≥, coletada com fita; foto macro documenta posi√ß√£o e contraste.\n\n- ev_footprint_photo_001: Marca de sola √∫mida com dire√ß√£o de fuga registrada; padr√£o simples, tamanho estimado 42‚Äì44."
    },
    {
      "title": "Local da Coleta e Condi√ß√µes",
      "content": "Coleta na loja de bairro e cal√ßada em frente. Ilumina√ß√£o interna neutra no momento (manh√£), cal√ßada √∫mida conforme observa√ß√£o da equipe. √Årea isolada pela primeira equipe policial a partir de 2025-09-01T09:35:00-04:00."
    },
    {
      "title": "Etiquetas e Identifica√ß√£o",
      "content": "Cada item recebeu etiqueta com ItemId, data/hora e coletado por. Impress√£o e CCTV receberam r√≥tulos espec√≠ficos indicando extra√ß√£o forense e operador (Per√≠cia / Per√≠cia Digital). Arquivos digitais receberam metadados b√°sicos e hash."
    },
    {
      "title": "Transfer√™ncias e Movimenta√ß√µes",
      "content": "Transfer√™ncias registradas: CCTV extra√≠da 2025-09-01T10:10:00-04:00 (Pen-drive forense); evid√™ncias f√≠sicas e digitais encaminhadas ao laborat√≥rio/per√≠cia em 2025-09-01T11:15:00-04:00. Registros de cadeia de cust√≥dia iniciados no local."
    },
    {
      "title": "Observa√ß√µes sobre Preserva√ß√£o",
      "content": "Evitar nova manipula√ß√£o da impress√£o; manter amostra em envelope selado. Fotografias e v√≠deos preservados em m√≠dia forense com c√≥pia de seguran√ßa. Receipts em PDF autenticados por metadados. Recomenda-se armazenamento seco e temperatura controlada at√© an√°lise. Notar que algumas evid√™ncias (CCTV) t√™m qualidade m√©dia; preservar original."
    }
  ]
}

###

# Teste de gera√ß√£o de PDF - Forensics
POST http://localhost:7071/api/test/pdf

{
  "docId": "doc_forensics_report_001",
  "type": "forensics_report",
  "title": "Laudo Pericial - Impress√µes e An√°lise de Imagens CCTV",
  "words": 432,
  "sections": [
    {
      "title": "Resumo Executivo",
      "content": "Laborat√≥rio: Laborat√≥rio Forense Municipal\nPerito: Perito Forense (identificador interno)\nData/Hora: 2025-09-01T11:30:00-04:00\n\nRelato compacto das an√°lises realizadas no incidente registrado em 2025-09-01T09:20:00-04:00 (assalto √† loja de bairro). Foram examinadas: fotografias da gaveta do caixa (ev_drawer_photo_001), fotografia macro da impress√£o parcial no puxador (ev_fingerprint_photo_001), fotografia da marca de sola na cal√ßada (ev_footprint_photo_001), c√≥pia digital dos recibos/relat√≥rio de caixa (ev_receipts_scan_001) e trecho de CCTV armazenado conforme item ev_cctv_video_001 (c√≥pia extra√≠da para pen-drive). Este laudo resume m√©todo, resultados preliminares, limita√ß√µes e recomenda√ß√µes para continuidade. Refer√™ncia interna ao relat√≥rio policial inicial: doc_police_report_001 e registro de evid√™ncias: doc_evidence_log_001."
    },
    {
      "title": "Metodologia",
      "content": "Procedimentos adotados (resumo):\n\n- Documenta√ß√£o fotogr√°fica in situ da gaveta e √°reas adjacentes conforme ev_drawer_photo_001, com r√©gua de escala e exposi√ß√£o neutra.\n- Levantamento e coleta de impress√£o parcial no puxador usando p√≥ e fita de levantamento; registro macro fotogr√°fico (ev_fingerprint_photo_001).\n- Fotografia da marca de sola na cal√ßada com r√©gua de escala e vista ampla para contexto (ev_footprint_photo_001).\n- C√≥pia forense do v√≠deo de vigil√¢ncia extra√≠da do DVR para pen-drive forense; timecode preservado (ev_cctv_video_001).\n- Digitaliza√ß√£o dos recibos e relat√≥rio de caixa conforme ev_receipts_scan_001 (300 dpi, PDF).\n\nAn√°lises realizadas: compara√ß√£o visual de padr√£o de sola, avalia√ß√£o qualitativa da impress√£o parcial, extra√ß√£o de frames do v√≠deo, medidas aproximadas de estatura por refer√™ncia de objetos fixos, e registro de todas as opera√ß√µes para cadeia de cust√≥dia. M√©todos seguem procedimentos b√°sicos do laborat√≥rio para casos de baixa complexidade."
    },
    {
      "title": "Resultados da An√°lise de Impress√µes",
      "content": "Impress√£o parcial (ev_fingerprint_photo_001): levantamento contendo fragmento correspondente a dois arcos digitais parciais. Qualidade: m√©dia-baixa por fragmenta√ß√£o e sobreposi√ß√£o de p√≥; pontos de refer√™ncia suficientes para an√°lise orientadora, n√£o conclusiva sem compara√ß√£o trif√°sica. A amostra foi acondicionada em envelope forense e registrada em cadeia de cust√≥dia.\n\nGaveta do caixa (ev_drawer_photo_001): fotografias mostram trilhos remexidos e marca de for√ßa compat√≠vel com remo√ß√£o manual. N√£o foram observadas impress√µes latentes claras nos registros fotogr√°ficos gerais; o puxador foi a fonte principal de impress√£o coletada.\n\nMarca de sola (ev_footprint_photo_001): padr√£o simples, di√¢metro e comprimento aproximados compat√≠veis com numera√ß√£o 42‚Äì44. Impress√£o √∫mida preservou sulcos b√°sicos; n√£o foi poss√≠vel identificar marca de fabricante ou padr√£o √∫nico que permita associa√ß√£o sem comparativo direto com suspeitos conhecidos ou base local de solas."
    },
    {
      "title": "Resultados da An√°lise de V√≠deo/CCTV",
      "content": "V√≠deo (ev_cctv_video_001): trecho de 30‚Äì45s extra√≠do com timecode preservado. Frame-chave mostra indiv√≠duo com capuz escuro entrando pela porta √†s 2025-09-01T09:20:00-04:00. Qualificadores observados: capuz cobrindo parte do rosto, jaqueta escura, mochila pequena, marcha r√°pida.\n\nEstimativa de estatura: 1,75‚Äì1,85 m com base em compara√ß√£o a moldura da porta e balc√£o. Comportamento: abordagem r√°pida ao balc√£o, manipula√ß√£o direta da gaveta, retirada e sa√≠da a p√© na dire√ß√£o indicada pela marca de sola.\n\nLimita√ß√µes do v√≠deo: resolu√ß√£o m√©dia, √¢ngulo frontal limitado, o capuz e baixa resolu√ß√£o impedem identifica√ß√£o facial confi√°vel. Gait e estatura podem orientar compara√ß√£o, mas n√£o s√£o per se identificadores exclusivos."
    },
    {
      "title": "Cadeia de Cust√≥dia",
      "content": "Eventos registrados em ordem cronol√≥gica:\n\n- 2025-09-01T09:36:00-04:00 ‚Äî Gaveta documentada e fotografada pela primeira equipe policial (refer√™ncia: ev_drawer_photo_001). Registro inicial em doc_evidence_log_001.\n- 2025-09-01T09:37:00-04:00 ‚Äî Fotografia da marca de sola coletada e preservada (ev_footprint_photo_001). Registro em doc_evidence_log_001.\n- 2025-09-01T09:40:00-04:00 ‚Äî Coleta de impress√£o parcial no puxador; amostra levantada com fita e fotografada (ev_fingerprint_photo_001). In√≠cio da etiqueta de cadeia de cust√≥dia.\n- 2025-09-01T09:45:00-04:00 ‚Äî Recebimento e c√≥pia dos recibos/relat√≥rio de caixa (ev_receipts_scan_001); entregue ao per√≠cia em envelope identificado.\n- 2025-09-01T10:10:00-04:00 ‚Äî Extra√ß√£o e c√≥pia forense do trecho de CCTV do DVR para pen-drive; metadados e timecode preservados (ev_cctv_video_001). Assinatura do respons√°vel pela extra√ß√£o registrada em doc_evidence_log_001.\n- 2025-09-01T11:15:00-04:00 ‚Äî Encaminhamento dos itens acima ao Laborat√≥rio Forense para an√°lise; recep√ß√£o e registro interno conclu√≠dos (entrada no sistema do laborat√≥rio)."
    },
    {
      "title": "Conclus√µes",
      "content": "As evid√™ncias documentadas indicam que a gaveta do caixa foi removida e que h√° discrep√¢ncia no relat√≥rio de caixa (ver ev_receipts_scan_001 e doc_police_report_001). A impress√£o parcial no puxador constitui um vest√≠gio potencialmente √∫til para compara√ß√£o laboratorial, embora fragmentada. O trecho de CCTV confirma presen√ßa de indiv√≠duo com capuz no hor√°rio do incidente e fornece par√¢metros de estatura e dire√ß√£o de fuga, mas √© insuficiente para identifica√ß√£o facial isolada.\n\nOs resultados s√£o consistentes entre si em termos temporais e contextuais, mas permanecem inconclusivos quanto √† autoria sem compara√ß√µes adicionais (bases de impress√£o, comparativos de solas, e testemunhos correlacionados)."
    },
    {
      "title": "Recomenda√ß√µes T√©cnicas",
      "content": "- Encaminhar a impress√£o parcial (ev_fingerprint_photo_001) para compara√ß√£o com base local de impress√µes e, se aplic√°vel, comparativos de suspeitos mencionados em investiga√ß√µes paralelas.\n- Realizar comparativo de padr√£o de sola entre a marca preservada (ev_footprint_photo_001) e amostras de cal√ßados recolhidos de pontos de interesse.\n- Processamento adicional das imagens de CCTV: aplica√ß√£o de t√©cnicas b√°sicas de realce e estabiliza√ß√£o de frames para melhorar medidas biom√©tricas n√£o faciais; preservar timecodes (ev_cctv_video_001).\n- Conservar todas as provas segundo a cadeia de cust√≥dia documentada; anexar c√≥pia digital dos recibos (ev_receipts_scan_001) ao processo pericial.\n- Recomenda-se correla√ß√£o com entrevistas registradas em doc_interview_ana_001 e declara√ß√µes de testemunhas para sustenta√ß√£o comparativa de tempo e movimento.\n\nTodas as a√ß√µes devem ser registradas em doc_evidence_log_001 e encaminhadas para continuidade investigativa conforme protocolos locais."
    }
  ]
}

###

# Teste de gera√ß√£o de Imagem - Footprint
POST http://localhost:7071/api/test/image
Content-Type: application/json

{
  "evidenceId": "ev_footprint_photo_001",
  "kind": "footprint_photo",
  "title": "Fotografia da marca de sola na cal√ßada",
  "prompt": "Uma fotografia forense de alta qualidade mostrando uma pegada/marca de sola de sapato na cal√ßada √∫mida. A imagem deve mostrar: pegada clara e definida com padr√£o de sola vis√≠vel, r√©gua de escala m√©trica posicionada ao lado para refer√™ncia de tamanho, superf√≠cie de cal√ßada cinza √∫mida que preservou bem a impress√£o, ilumina√ß√£o forense adequada sem sombras excessivas, qualidade documental apropriada para evid√™ncia criminal. A pegada deve ter caracter√≠sticas de um t√™nis ou sapato casual, tamanho aproximado 42-44, com padr√£o de sola que permite an√°lise posterior.",
  "constraints": "- Estilo: fotografia forense realista\n- Qualidade: alta resolu√ß√£o, foco n√≠tido\n- Ilumina√ß√£o: profissional, sem sombras que prejudiquem a an√°lise\n- Elementos obrigat√≥rios: r√©gua de escala, numera√ß√£o/identifica√ß√£o da evid√™ncia\n- Contexto: investiga√ß√£o da policia, cal√ßada urbana\n- Perspectiva: vista superior (bird's eye view) para an√°lise t√©cnica"
}


###

#Teste imagem 2
POST http://localhost:7071/api/test/image
Content-Type: application/json

{
  "evidenceId": "ev_app_comprovante_001",
  "kind": "document_scan",
  "title": "Comprovante de Entrega do Aplicativo (19:06‚Äì19:12)",
  "prompt": "Fun√ß√£o: comprovar a janela temporal do servi√ßo no aplicativo com tr√™s eventos principais ‚Äî check-in √†s 19:06, assinatura confirmada √†s 19:11 (iniciais da cliente apenas) e check-out √†s 19:12 ‚Äî com ID de rota parcialmente vis√≠vel e carimbo de gera√ß√£o do documento. Aplicar reda√ß√£o de dados sens√≠veis conforme pol√≠tica.\n\nCena/Composi√ß√£o:\n- Documento em PDF, p√°gina √∫nica em orienta√ß√£o retrato, layout neutro e gen√©rico de comprovante (sem marcas/nomes de empresas), com t√≠tulo textual simples \"Comprovante de Entrega\" no topo.\n- Corpo em se√ß√£o √∫nica contendo tabela simples com 3 linhas de eventos: \"Check-in ‚Äî 19:06\", \"Assinatura ‚Äî 19:11\", \"Check-out ‚Äî 19:12\". Coluna de observa√ß√µes sucinta (opcional) sem nomes de locais espec√≠ficos.\n- Campo \"Assinatura\" exibindo texto: \"Assinatura: N. P.\" (restante redigido com bloco s√≥lido). N√£o mostrar a assinatura manuscrita; apenas confirma√ß√£o textual de assinatura.\n- Campo \"ID de rota\" parcialmente vis√≠vel (padr√£o alfanum√©rico com 4 √∫ltimos d√≠gitos vis√≠veis; demais caracteres redigidos com blocos s√≥lidos). Ex.: \"Rota: XXXX-XXXX-1234\".\n- Rodap√© com carimbo do sistema: \"Gerado √†s 19:12\" e hash interno abreviado (exibir apenas 6 √∫ltimos caracteres; o restante redigido).\n- Margens uniformes vis√≠veis de 5‚Äì8 mm ao redor do conte√∫do. Documento ocupa 92‚Äì95% do quadro (sem cortes nas bordas).\n- Interface textual sem √≠cones propriet√°rios; qualquer √°rea onde normalmente haveria logotipo deve permanecer vazia ou com marcador gen√©rico [LOGO] redigido.\n\n√Çngulo & Dist√¢ncia:\n- Captura ortogr√°fica tipo scanner, top-down a 90¬∞ (sem perspectiva). Dist√¢ncia n√£o aplic√°vel (superf√≠cie de vidro do scanner). Linhas horizontais/verticais alinhadas, sem inclina√ß√£o.\n\nIlumina√ß√£o & T√©cnica:\n- Digitaliza√ß√£o a 300 DPI, contraste alto, balan√ßo de branco neutro. Sem moir√©, sem reflexos, sem granula√ß√£o.\n- Corre√ß√£o de perspectiva e corte apenas para manter margens regulares. Nitidez homog√™nea em toda a p√°gina (foco √≥ptico do scanner calibrado; profundidade de campo total por ser captura plana).\n- Compress√£o sem perdas ou m√≠nima; gerar em PDF (texto nativo quando poss√≠vel). Perfil de cor sRGB ou escala de cinza neutra.\n\nElementos obrigat√≥rios:\n- Timestamps claramente leg√≠veis: 19:06 (check-in), 19:11 (assinatura), 19:12 (check-out) e carimbo \"Gerado √†s 19:12\" no rodap√©.\n- ID de rota parcialmente vis√≠vel com reda√ß√£o aplicada.\n- Reda√ß√£o de dados sens√≠veis (nomes completos, IDs extensos, telefones, endere√ßos) com blocos s√≥lidos opacos e etiqueta discreta \"[REDACTED]\" opcional.\n- Margens vis√≠veis e corre√ß√£o de perspectiva confirmadas.\n- Aus√™ncia total de marcas/logotipos reconhec√≠veis e de quaisquer fotografias de pessoas.\n\nVaria√ß√µes/Sequ√™ncia de tomadas (se houver):\n- Tomada A (principal): p√°gina inteira do comprovante conforme acima.\n- Tomada B (detalhe): recorte em 150‚Äì200% de amplia√ß√£o apenas da √°rea central com a tabela de eventos e o campo de assinatura, mantendo a reda√ß√£o aplicada e as horas leg√≠veis. Ambas as tomadas no mesmo PDF como p√°ginas 1 (A) e 2 (B).\n\nNegativos (N√ÉO fazer):\n- N√£o incluir logotipos, nomes comerciais ou marcas registradas.\n- N√£o exibir nome completo da signat√°ria, ID de rota completo, telefones, e-mails ou endere√ßos.\n- N√£o cortar margens, n√£o inclinar, n√£o usar filtros art√≠sticos ou efeitos.\n- N√£o inserir dedos, sombras duras, reflexos, vinhetas ou moir√©.\n- N√£o reformatar os hor√°rios; manter nota√ß√£o de 24h padronizada.\n\nChecklist de aceita√ß√£o:\n1) √Çngulo de c√¢mera e dist√¢ncia: top-down 90¬∞ ortogonal (scanner), sem perspectiva; documento ocupa 92‚Äì95% do quadro.\n2) Elementos obrigat√≥rios: hor√°rios 19:06/19:11/19:12 leg√≠veis; \"Gerado √†s 19:12\" no rodap√©; ID de rota parcialmente vis√≠vel; reda√ß√£o aplicada; margens vis√≠veis.\n3) Proibi√ß√£o expl√≠cita: nenhuma pessoa, rosto, m√£os, marcas ou logotipos reconhec√≠veis.\n4) Composi√ß√£o: enquadramento com margens regulares; sem recorte excessivo; hierarquia de leitura clara (t√≠tulo, tabela, rodap√©).\n5) Ilumina√ß√£o e t√©cnica: 300 DPI; contraste alto; nitidez homog√™nea; balan√ßo neutro; sem moir√©; corre√ß√£o de perspectiva.\n6) Negativos: evitar qualquer distor√ß√£o, filtros, cortes de borda, dados sens√≠veis sem reda√ß√£o e qualquer elemento que identifique marca ou pessoa.",
  "constraints": "angle=top-down 90¬∞ (ortogonal, sem perspectiva); lighting=difusa e uniforme (scanner), balan√ßo de branco neutro, sem sombras; scale=A4 em retrato a 300 DPI; conte√∫do ocupa 92‚Äì95% com margens de 5‚Äì8 mm vis√≠veis; deferred=false; seed=14721; size=1024x1024; dpi=300; redacao_dados_sensiveis=true; contraste=alto; formato=PDF; correcao_perspectiva=true; margens_visiveis=true"
}


###

#Outra
POST http://localhost:7071/api/test/image
Content-Type: application/json

{
  "evidenceId": "ev_brilho_001",
  "kind": "photo",
  "title": "Frame de C√¢mera Interna - Cliente Inclina-se e Retira Envelope (18:26:14)",
  "prompt": "Fun√ß√£o: Registrar, em estilo CFTV documental, o exato momento em que um cliente, com rosto anonimizado, inclina-se sobre o balc√£o e puxa um envelope fino da divis√≥ria frontal de uma gaveta de caixa parcialmente aberta, para correla√ß√£o temporal com logs do PDV. Cena/Composi√ß√£o: Interior de uma pequena loja de bairro, balc√£o do caixa ao centro-esquerda; gaveta do caixa parcialmente aberta com divis√≥rias vis√≠veis; envelope fino de papel pardo/bege sendo tracionado pela m√£o direita do cliente a partir da divis√≥ria frontal; cliente usando bon√© verde liso (sem logotipos) e camisa lisa neutra; prateleiras ao fundo com produtos gen√©ricos, r√≥tulos/logos desfocados para n√£o serem reconhec√≠veis; equipamento de PDV/terminal no balc√£o sem marcas; composi√ß√£o ampla preservando contexto do balc√£o, parte do corredor e prateleiras. O conjunto gaveta+envelope ocupa aprox. 35‚Äì45% do quadro; o cliente aparece apenas do torso para cima, com rosto borrado; fundo ocupa 35‚Äì40% do quadro. Timestamp no canto superior direito; identifica√ß√£o da c√¢mera no canto superior esquerdo. √Çngulo & Dist√¢ncia: C√¢mera de seguran√ßa fixa interna, perspectiva frontal do balc√£o a partir de altura de 2,7 m, inclina√ß√£o de ~20deg para baixo; dist√¢ncia horizontal aproximada de 2,2 m at√© a gaveta; lente grande-angular moderada (~3.6 mm eq.) com linhas verticais niveladas (sem tilt), sem distor√ß√£o excessiva. Ilumina√ß√£o & T√©cnica: Ilumina√ß√£o ambiente fluorescente difusa e uniforme; balan√ßo de branco neutro (aprox. 4600‚Äì5000 K); exposi√ß√£o neutra; profundidade de campo alta com nitidez homog√™nea (equivalente a f/8‚Äìf/11); velocidade equivalente a 1/120 s para congelar gesto; ISO moderado (~400) com ru√≠do contido; resolu√ß√£o 1080p (1920x1080); compress√£o H.264 moderada t√≠pica de CFTV; foco no plano do balc√£o/gaveta; sem sombras duras. Elementos obrigat√≥rios: Overlay de timestamp monoespa√ßado, branco com contorno/preenchimento de borda escura para legibilidade, exibindo exatamente \"2025-09-04 18:26:14 -04:00\" no canto superior direito; r√≥tulo da c√¢mera \"Cam1\" no canto superior esquerdo, tamb√©m em fonte monoespa√ßada branca com contorno; rosto(s) de pessoa(s) presentes borrados (desfoque gaussiano discreto) garantindo anonimiza√ß√£o; aus√™ncia de logotipos/marcas identific√°veis em roupas, equipamentos e produtos (r√≥tulos desfocados); sem marcas d‚Äô√°gua propriet√°rias. Varia√ß√µes/Sequ√™ncia de tomadas (se houver): 1) Plano geral (principal) conforme descrito; 2) Leve aproxima√ß√£o digital (1.3x‚Äì1.5x) mantendo timestamp e r√≥tulo vis√≠veis, para evidenciar o envelope saindo da gaveta, sem recorte dram√°tico e sem perder contexto. Ambas dentro do mesmo segundo 18:26:14. Negativos (N√ÉO fazer): N√£o mostrar rostos identific√°veis (obrigat√≥rio borrar); n√£o exibir logotipos/marcas reconhec√≠veis; n√£o usar √¢ngulo dram√°tico, dutch tilt ou zoom extremo; n√£o aplicar filtros art√≠sticos, HDR, vinhetas; n√£o cortar a ponto de perder o balc√£o/gaveta; n√£o remover/alterar timestamp; n√£o inserir textos como nome da evid√™ncia; n√£o usar ilumina√ß√£o pontual que crie sombras duras. Checklist de aceita√ß√£o: 1) √Çngulo frontal a 2,7 m de altura e ~20deg para baixo, dist√¢ncia ~2,2 m, coerente com CFTV; 2) Timestamp e r√≥tulo da c√¢mera presentes e leg√≠veis (monoespa√ßado, branco com contorno); 3) Pessoas permitidas por√©m com rostos borrados, e proibi√ß√£o expl√≠cita de logos; 4) Composi√ß√£o define: gaveta+envelope ~35‚Äì45% do quadro, contexto preservado; 5) T√©cnica: ilumina√ß√£o difusa, WB neutro, nitidez homog√™nea, par√¢metros equivalentes a f/8‚Äìf/11; 6) Negativos listados (sem zoom dram√°tico, sem marcas, sem remo√ß√£o de timestamp, sem nome da evid√™ncia no frame).",
  "constraints": "angulo=frontal; camera_height=2.7m; tilt=20deg_down; distancia_sujeito‚âà2.2m; lente‚âà3.6mm_eq; iluminacao=fluorescente_difusa_WB_4600-5000K; exposicao=f/8‚Äìf/11_1/120s_ISO400; resolucao=1080p_1920x1080; compressao=H.264_moderada; timestamp_overlay=monoespacado_branco_com_contorno_'2025-09-04 18:26:14 -04:00'_canto_sup_dir; camera_label=Cam1_canto_sup_esq; anonymizacao=ativa_faces_borradas_gaussiano_raio_16-24px; logos_desfocados=true; escala=assunto_35-45_percent_do_quadro; recorte=leve_aproximacao_max_1.5x; perspectiva=compat√≠vel_CFTV_altura_2.5-3m; deferred=false; seed=ev_brilho_001_v1"
}